目標：Python版・Ruby版のデザインパターンを作る

(PythonやRubyは型指定がないのでjavaやC#と比べるとかなり毛色が違いそう。。。)

多くのパターンが型指定が必要なjavaで修正しなくてよいという前提で構成されている（左記目的の場合にPython, Rubyでは不要な場合が多い）

デザインパターンを学ぶ目的

- 変更に強い（変更箇所が少ない？）プログラムを作成できる
- 再利用ができる
- バグが少ないプログラムが作成できる



# 生成

## Abstract Factory

### 概要

- クラス生成用のクラスを作成する
- 抽象クラスを作成して具体クラスを追加していく

#### メリット・使いどころ

- クラスの生成を保証する
- クラスの入替が必要最低限で済む(ファクトリークラス生成用の引数と、新規ファクトリークラス)
- 同種のクラスが多い場合（RPGのキャラクターとか？？）

###  具体例

- 鍋クラスを作成する

## Builder

### 概要

- 要素の保持・演算用クラス(Builderクラス)と構築用クラス(Directorクラス)を別々に作成する
- Builderはインターフェースとして用意してそれをインターフェースとして継承した要素・演算用クラスとする

#### メリット・使いどころ

- 異なる要素だが同じ過程で作る（食塩水と砂糖水とか？？）場合にDirectorクラスを再利用できる

### 具体例

- 食塩水を作成する

## Factory Method

### 概要

- クラス生成をメソッドで実施する（直接コンストラクタを呼ばない）

#### メリット・使いどころ

- 継承側で生成するインスタンスを決定したい場合（メソッドをオーバーライドする）

### 具体例

- 版材(cuttableクラス：芋、木等)を使って加工する（cutprintクラス：書く、切る、プリントする）



## Prototype

### 概要

- プロトタイプ(インスタンス？）からインスタンスを作成できるようにするパターン

## Singleton

### 概要

- あるクラスの生成インスタンスが唯一であることを保証するパターン

#### メリット・使いどころ

- インスタンスが唯一であることを保証したい場合に使用する

### 具体例

- 図書館貸出の際の本が1つである？

### その他

- Pythonのコードは少し特殊

  | Pythonコードの大体の流れ                                     |
  | ------------------------------------------------------------ |
  | __init__の前にnewが呼び出されるのでnewの時点でraiseする      |
  | getinstance時にinternalnewでnewをラッパーする                |
  | 結果：通常インスタンス生成時はnewの例外がraiseされる         |
  | 結果：getintance時にuniqueinstanceが無ければ生成しあれば生成しない |
  | 上記でinstanceの唯一性が確保される                           |

  ```python
  class Singleton:
      _unique_instance = None
      ## 1. get_instance時に__init__が呼び出されるので
      ## その前にraiseする
      def __new__(cls):
          raise NotImplementedError('Cannot initialize via Constructor')
  	
      ## get_instance時に呼び出されるnewをwrapperする
      @classmethod
      def __internal_new__(cls):
          return super().__new__(cls)
  
      ## _unique_instanceが存在しない場合のみ生成を許可する
      @classmethod
      def get_instance(cls):
          if not cls._unique_instance:
              cls._unique_instance = cls.__internal_new__()  # 変更
  
          return cls._unique_instance
  ```

  

## Bridge

### 概要

- メソッドを保有インスタンスに委譲させる(sortメソッドをSortImpleインスタンスに投げる)

#### メリット・使いどころ

- 抽象クラスから継承されている具体メソッドを再記述することなく利用したい場合

### 具体例

- sortメソッドをSortImpleインスタンスに委譲する

## Template Method

### 概要

- 抽象クラスで処理の枠組み（描く、切る、プリントする等）を決めること(サブクラスで実装する）

#### メリット・使いどころ

- 必要なメソッド等を親クラスでをあらかじめ定めることができること（このパターンは親クラスが提供する機能そのものが利点）

### 具体例

- 木材に版画をする

